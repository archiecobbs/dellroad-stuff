<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>PersistentObject (DellRoad Stuff 3.0.1 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: org.dellroad.stuff.pobj, class: PersistentObject">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/PersistentObject.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.dellroad.stuff.pobj</a></div>
<h1 title="Class PersistentObject" class="title">Class PersistentObject&lt;T&gt;</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">org.dellroad.stuff.pobj.PersistentObject&lt;T&gt;</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>T</code> - type of the root object</dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">PersistentObject&lt;T&gt;</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">Main class for Simple XML Persistence Objects (POBJ).

 <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.27.0/prism.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.27.0/components/prism-java.min.js"></script>
 <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.27.0/themes/prism.min.css" rel="stylesheet"/>

 <h3>Overview</h3>

 <p>
 A <a href="PersistentObject.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObject</code></a> instance manages an in-memory database with ACID semantics and strict validation that is
 represented by a regular Java object graph (i.e., a root Java object and all of the other objects that it (indirectly)
 references). The object graph can be (de)serialized to/from XML, and this XML representation is used for persistence
 in the file system. The backing XML file is read in at initialization time and updated after each change.

 <p>
 All changes required copying the entire object graph, and are atomic and strictly serialized. In other words, the
 entire object graph is read and written by value. On the filesystem, the persistent XML file
 is updated by writing out a new, temporary copy and renaming the copy onto the original, using <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html#renameTo(java.io.File)" title="class or interface in java.io" class="external-link"><code>File.renameTo()</code></a> so that changes are also atomic from a filesystem perspective, i.e., it's not possible to open an
 invalid or partial XML file (assuming filesystem renames are atomic, e.g., all UNIX variants). This class also
 supports information flowing in the other direction, where we pick up "out of band" updates to the XML file (see below).

 <p>
 This class is most appropriate for use with information that must be carefully controlled and validated,
 but that doesn't change frequently. Configuration information for an application stored in a <code>config.xml</code>
 file is a typical use case; beans whose behavior is determined by the configured information can subclass
 <a href="AbstractConfiguredBean.html" title="class in org.dellroad.stuff.pobj"><code>AbstractConfiguredBean</code></a> and have their lifecycles managed automatically.

 <p>
 Because each change involves copying of the entire graph, an efficient graph copy operation is desirable.
 The <a href="AbstractDelegate.html#copy(T)">default method</a> is to serialize and then deserialize the object graph
 to/from XML in memory. See <a href="../java/GraphCloneable.html" title="interface in org.dellroad.stuff.java"><code>GraphCloneable</code></a> for a much more efficient approach.

 <h3>Validation</h3>

 <p>
 Validation is peformed in Java (not in XML) and defined by the provided <a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a>. This delegate
 guarantees that only a valid root Java object can be read or written. Setting an invalid Java root object via
 <a href="#setRoot(T,long,boolean)"><code>setRoot()</code></a> with throw an exception; reading an invalid XML file on disk will generate
 an error (or be ignored; see "Empty Starts" below).

 <h3>Update Details</h3>

 <p>
 When the object graph is updated, it must pass validation checks, and then the persistent XML file is updated and
 listener notifications are sent out. Listeners are always notified in a separate thread from the one that invoked
 <a href="#setRoot(T,long,boolean)"><code>setRoot()</code></a>. Support for delayed write-back of the persistent XML file is included: this
 allows modifications that occur in rapid succession to be consolidated into a single filesystem write operation.

 <p>
 Support for optimistic locking is included. There is a "current version" number which is incremented each
 time the object graph is updated; writes may optionally specify this number to ensure no intervening changes
 have occurred. If concurrent updates are expected, applications may choose to implement a 3-way merge algorithm
 of some kind to handle optimistic locking failures.

 <p>
 To implement a truly atomic read-modify-write operation without the possibility of locking failure, simply
 synchronize on this instance, e.g.:
  <pre><code class="language-java">
  synchronized (pobj) {
      MyRoot root = pboj.getRoot();
      root.setFoobar("new value");    // or whatever else we want to modify
      pobj.setRoot(root);
  }
  </code></pre>

 <p>
 Instances can also be configured to automatically preserve one or more backup copies of the persistent file on systems that
 support hard links (see <a href="../io/FileStreamRepository.html" title="class in org.dellroad.stuff.io"><code>FileStreamRepository</code></a>). Set the <a href="#getNumBackups()"><code>numBackups</code></a> property to enable.

 <h3>"Out-of-band" Writes</h3>

 <p>
 When a non-zero <a href="#getCheckInterval()">check interval</a> is configured, instances support "out-of-band" writes
 directly to the XML persistent file by some other process. This can be handy in cases where the other process (perhaps hand
 edits) is updating the persistent file and you want to have the running Java process pick up the changes just as if
 <a href="#setRoot(T,long,boolean)"><code>setRoot()</code></a> had been invoked. In particular, instances will detect the appearance
 of a newly appearing persistent file after has starting without one (see "empty starts" below). In all cases, persistent
 objects must properly validate. To avoid reading a partial file the external process should write the file atomically by
 creating a temporary file and renaming it; however, this race window is small and in any case the problem is self-correcting
 because a partially written XML file will not validate, and so it will be ignored and retried after another
 <a href="#getCheckInterval()">check interval</a> milliseconds has passed.

 <p>
 A special case of this is effected when <a href="#setRoot(T,long,boolean)"><code>setRoot()</code></a> is never explicitly invoked
 by the application. Then some other process must be responsible for all database updates via XML file, and this class
 will automatically pick them up, validate them, and send out notifications to listeners.

 <h3>Empty Starts and Stops</h3>

 <p>
 An "empty start" occurs when an instance is <a href="#start()">started</a> but the persistent XML file is either missing,
 does not validate, or cannot be read for some other reason. In such cases, the instance will start with no object graph,
 and <a href="#getRoot()"><code>getRoot()</code></a> will return null. This situation will correct itself as soon as the object graph is written via
 <a href="#setRoot(T,long,boolean)"><code>setRoot()</code></a> or the persistent file appears (effecting an "out-of-band" update). At that time, <a href="#addListener(org.dellroad.stuff.pobj.PersistentObjectListener)">listeners</a> will be notified for the first time, with <a href="PersistentObjectEvent.html#getOldRoot()"><code>PersistentObjectEvent.getOldRoot()</code></a> returning null.

 <p>
 Whether empty starts are allowed is determined by the <a href="#isAllowEmptyStart()"><code>allowEmptyStart</code></a> property (default
 <code>false</code>). When empty starts are disallowed and the persistent XML file cannot be successfully read,
 then <a href="#start()"><code>start()</code></a> will instead throw an immediate <a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObjectException</code></a>.

 <p>
 Similarly, "empty stops" are allowed when the <a href="#isAllowEmptyStop()"><code>allowEmptyStop</code></a> property is set to <code>true</code>
 (by default it is <code>false</code>). An "empty stop" occurs when a null value is passed to <a href="#setRoot(T,long,boolean)"><code>setRoot()</code></a>
 (note, an invalid XML file appearing on disk does not cause an empty start).
 Subsequent invocations of <a href="#getRoot()"><code>getRoot()</code></a> will return <code>null</code>. The persistent file is <b>not</b>
 modified when null is passed to <a href="#setRoot(T,long,boolean)"><code>setRoot(T, long, boolean)</code></a>. When empty stops are disallowed, then invoking
 <a href="#setRoot(T,long,boolean)"><code>setRoot(T, long, boolean)</code></a> with a <code>null</code> object will result in an <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link"><code>IllegalArgumentException</code></a>.

 <p>
 Allowing empty starts and/or stops essentially creates an "unconfigured" state represented by a null root object.
 When empty starts and empty stops are both disallowed, there is no "unconfigured" state: once started, <a href="#getRoot()"><code>getRoot()</code></a>
 can be relied upon to always return a non-null, validated root object.

 <p>
 See <a href="AbstractConfiguredBean.html" title="class in org.dellroad.stuff.pobj"><code>AbstractConfiguredBean</code></a> for a useful superclass that automatically handles starting and stopping
 based on the state of an associated <a href="PersistentObject.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObject</code></a>.

 <h3>Shared Roots</h3>

 Each time <a href="#setRoot(T,long,boolean)"><code>setRoot()</code></a> or <a href="#getRoot()"><code>getRoot()</code></a> is invoked, a deep copy of the root object
 is made. This prevents external code from changing any node in the "official" object graph held by this instance,
 and allows invokers of <a href="#getRoot()"><code>getRoot()</code></a> to modify to the returned object graph without affecting other invokers.
 However, there may be cases where this deep copy is an expensive operation in terms of time or memory.
 The <a href="#getSharedRoot()"><code>getSharedRoot()</code></a> method can be used in these situations. This method returns the same
 root object each time it is invoked (this shared root is itself a deep copy of the "official" root). Therefore, only
 the very first invocation pays the price of a copy. However, all invokers of <a href="#getSharedRoot()"><code>getSharedRoot()</code></a>
 must treat the object graph as read-only to avoid each other seeing unexpected changes.

 <h3>Delegate Function</h3>

 <p>
 Instances must be configured with a <a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a> that knows how to validate the object graph
 and perform conversions to and from XML. See <a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a> and its implementations for details.

 <h3>Schema Changes</h3>

 <p>
 Like any database, the XML schema may evolve over time. The <a href="PersistentObjectSchemaUpdater.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObjectSchemaUpdater</code></a> class provides a simple
 way to apply and manage schema updates using XSLT transforms.

 <h3>Transaction Manager</h3>

 <p>
 If using Spring, consider using a <a href="PersistentObjectTransactionManager.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObjectTransactionManager</code></a> for transactional access to a
 <a href="PersistentObject.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObject</code></a>.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list-long">
<li><a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a></li>
<li><a href="PersistentObjectSchemaUpdater.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObjectSchemaUpdater</code></a></li>
<li><a href="PersistentObjectTransactionManager.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObjectTransactionManager</code></a></li>
<li><a href="AbstractConfiguredBean.html" title="class in org.dellroad.stuff.pobj"><code>AbstractConfiguredBean</code></a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>class&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="PersistentObject.Snapshot.html" class="type-name-link" title="class in org.dellroad.stuff.pobj">PersistentObject.Snapshot</a></code></div>
<div class="col-last even-row-color">
<div class="block">Holds a "snapshot" of a <a href="PersistentObject.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObject</code></a> root object along with the version number
 corresponding to the snapshot.</div>
</div>
</div>
</section>
</li>
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>protected final <a href="https://www.slf4j.org/apidocs/org/slf4j/Logger.html" title="class or interface in org.slf4j" class="external-link">Logger</a></code></div>
<div class="col-second even-row-color"><code><a href="#log" class="member-name-link">log</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">PersistentObject</a>()</code></div>
<div class="col-last even-row-color">
<div class="block">Default constructor.</div>
</div>
<div class="col-constructor-name odd-row-color"><code><a href="#%3Cinit%3E(org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.File)" class="member-name-link">PersistentObject</a><wbr>(<a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;file)</code></div>
<div class="col-last odd-row-color">
<div class="block">Simplified constructor configuring for immediate write-back and no persistent file checks.</div>
</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.File,long,long)" class="member-name-link">PersistentObject</a><wbr>(<a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;file,
 long&nbsp;writeDelay,
 long&nbsp;checkInterval)</code></div>
<div class="col-last even-row-color">
<div class="block">Constructor.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#addListener(org.dellroad.stuff.pobj.PersistentObjectListener)" class="member-name-link">addListener</a><wbr>(<a href="PersistentObjectListener.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectListener</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;listener)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Add a listener to be notified each time the object graph changes.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#checkFile()" class="member-name-link">checkFile</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Check the persistent file for an "out-of-band" update.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/transform/Result.html" title="class or interface in javax.xml.transform" class="external-link">Result</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#createResult(java.io.OutputStream,java.io.File)" class="member-name-link">createResult</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link">OutputStream</a>&nbsp;output,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;systemId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Create a <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/transform/Result.html" title="class or interface in javax.xml.transform" class="external-link"><code>Result</code></a> targeting the given <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link"><code>OutputStream</code></a>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>long</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getCheckInterval()" class="member-name-link">getCheckInterval</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Get the delay time between periodic checks for changes in the underlying persistent file.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getDelegate()" class="member-name-link">getDelegate</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Get the configured <a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getFile()" class="member-name-link">getFile</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Get the persistent file containing the XML form of the persisted object.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getNumBackups()" class="member-name-link">getNumBackups</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Get the number of backup copies to preserve.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="PersistentObject.html" title="type parameter in PersistentObject">T</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getRoot()" class="member-name-link">getRoot</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Atomically read the root object.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="PersistentObject.html" title="class in org.dellroad.stuff.pobj">PersistentObject</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;.<a href="PersistentObject.Snapshot.html" title="class in org.dellroad.stuff.pobj">Snapshot</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getRootSnapshot()" class="member-name-link">getRootSnapshot</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Read the root object (as with <a href="#getRoot()"><code>getRoot()</code></a>) and its version (as with <a href="#getVersion()"><code>getVersion()</code></a>) in one atomic operation.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="PersistentObject.html" title="type parameter in PersistentObject">T</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getSharedRoot()" class="member-name-link">getSharedRoot</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Get a shared copy of the root object.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="PersistentObject.html" title="class in org.dellroad.stuff.pobj">PersistentObject</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;.<a href="PersistentObject.Snapshot.html" title="class in org.dellroad.stuff.pobj">Snapshot</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getSharedRootSnapshot()" class="member-name-link">getSharedRootSnapshot</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Read the shared root object (as with <a href="#getSharedRoot()"><code>getSharedRoot()</code></a>) and its version (as with <a href="#getVersion()"><code>getVersion()</code></a>)
 in one atomic operation.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>long</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getVersion()" class="member-name-link">getVersion</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Get the version of the current root.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>long</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getWriteDelay()" class="member-name-link">getWriteDelay</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Get the maximum delay after an update operation before a write-back to the persistent file
 must be initiated.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#hasRoot()" class="member-name-link">hasRoot</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Determine whether this instance has a non-null root object.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isAllowEmptyStart()" class="member-name-link">isAllowEmptyStart</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Determine whether this instance should allow an "empty start".</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isAllowEmptyStop()" class="member-name-link">isAllowEmptyStop</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Determine whether this instance should allow an "empty stop".</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isStarted()" class="member-name-link">isStarted</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Determine whether this instance is started.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#notifyListeners(long,T,T)" class="member-name-link">notifyListeners</a><wbr>(long&nbsp;newVersion,
 <a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;oldRoot,
 <a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;newRoot)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Notify listeners of a change in value.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected <a href="PersistentObject.html" title="type parameter in PersistentObject">T</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#read()" class="member-name-link">read</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Read the persistent file.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static &lt;T&gt;&nbsp;T</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#read(org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.File,boolean)" class="member-name-link">read</a><wbr>(<a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;file,
 boolean&nbsp;validate)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Read in a persistent object from the given <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link"><code>File</code></a> using the given delegate.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static &lt;T&gt;&nbsp;T</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#read(org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.InputStream,boolean)" class="member-name-link">read</a><wbr>(<a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/InputStream.html" title="class or interface in java.io" class="external-link">InputStream</a>&nbsp;input,
 boolean&nbsp;validate)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Read in a persistent object from the given <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/InputStream.html" title="class or interface in java.io" class="external-link"><code>InputStream</code></a> using the given delegate.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static &lt;T&gt;&nbsp;T</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#read(org.dellroad.stuff.pobj.PersistentObjectDelegate,javax.xml.transform.Source,boolean)" class="member-name-link">read</a><wbr>(<a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/transform/Source.html" title="class or interface in javax.xml.transform" class="external-link">Source</a>&nbsp;source,
 boolean&nbsp;validate)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Read in a persistent object using the given delegate.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#removeListener(org.dellroad.stuff.pobj.PersistentObjectListener)" class="member-name-link">removeListener</a><wbr>(<a href="PersistentObjectListener.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectListener</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;listener)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Remove a listener added via <a href="#addListener(org.dellroad.stuff.pobj.PersistentObjectListener)"><code>addListener()</code></a>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setAllowEmptyStart(boolean)" class="member-name-link">setAllowEmptyStart</a><wbr>(boolean&nbsp;allowEmptyStart)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Configure whether an "empty start" is allowed.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setAllowEmptyStop(boolean)" class="member-name-link">setAllowEmptyStop</a><wbr>(boolean&nbsp;allowEmptyStop)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Configure whether an "empty stop" is allowed.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setCheckInterval(long)" class="member-name-link">setCheckInterval</a><wbr>(long&nbsp;checkInterval)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Set the delay time between periodic checks for changes in the underlying persistent file.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setDelegate(org.dellroad.stuff.pobj.PersistentObjectDelegate)" class="member-name-link">setDelegate</a><wbr>(<a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;delegate)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Configure the <a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setFile(java.io.File)" class="member-name-link">setFile</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;file)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Set the persistent file containing the XML form of the persisted object.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setNumBackups(int)" class="member-name-link">setNumBackups</a><wbr>(int&nbsp;numBackups)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Set the number of backup copies to preserve.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>final long</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setRoot(T)" class="member-name-link">setRoot</a><wbr>(<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;newRoot)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Atomically update the root object.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>long</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setRoot(T,long)" class="member-name-link">setRoot</a><wbr>(<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;newRoot,
 long&nbsp;expectedVersion)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Atomically update the root object.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>long</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setRoot(T,long,boolean)" class="member-name-link">setRoot</a><wbr>(<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;newRoot,
 long&nbsp;expectedVersion,
 boolean&nbsp;alreadyValidated)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Atomically update the root object.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setWriteDelay(long)" class="member-name-link">setWriteDelay</a><wbr>(long&nbsp;writeDelay)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Set the maximum delay after an update operation before a write-back to the persistent file
 must be initiated.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#start()" class="member-name-link">start</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Start this instance.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#stop()" class="member-name-link">stop</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Stop this instance.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toString()" class="member-name-link">toString</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Get a simple string description of this instance.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#validate(T)" class="member-name-link">validate</a><wbr>(<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;root)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Validate a root object.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected final void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#write(T)" class="member-name-link">write</a><wbr>(<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;obj)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Write the persistent file and rotate any backups.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static &lt;T&gt;&nbsp;void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#write(T,org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.File)" class="member-name-link">write</a><wbr>(T&nbsp;root,
 <a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;file)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Write a persistent object using the given delegate.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static &lt;T&gt;&nbsp;void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#write(T,org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.OutputStream)" class="member-name-link">write</a><wbr>(T&nbsp;root,
 <a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link">OutputStream</a>&nbsp;output)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Write a persistent object using the given delegate.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static &lt;T&gt;&nbsp;void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#write(T,org.dellroad.stuff.pobj.PersistentObjectDelegate,javax.xml.transform.Result)" class="member-name-link">write</a><wbr>(T&nbsp;root,
 <a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/transform/Result.html" title="class or interface in javax.xml.transform" class="external-link">Result</a>&nbsp;result)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Write a persistent object using the given delegate.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="log">
<h3>log</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type"><a href="https://www.slf4j.org/apidocs/org/slf4j/Logger.html" title="class or interface in org.slf4j" class="external-link">Logger</a></span>&nbsp;<span class="element-name">log</span></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.File,long,long)">
<h3>PersistentObject</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">PersistentObject</span><wbr><span class="parameters">(<a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;file,
 long&nbsp;writeDelay,
 long&nbsp;checkInterval)</span></div>
<div class="block">Constructor.

 <p>
 The <code>writeDelay</code> is the maximum delay after an update operation before a write-back to the persistent file
 must be initiated.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>delegate</code> - delegate supplying required operations</dd>
<dd><code>file</code> - the file used to persist</dd>
<dd><code>writeDelay</code> - write delay in milliseconds, or zero for immediate write-back</dd>
<dd><code>checkInterval</code> - check interval in milliseconds, or zero to disable persistent file checks</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>delegate</code> or <code>file</code> is null</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>writeDelay</code> or <code>checkInterval</code> is negative</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.File)">
<h3>PersistentObject</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">PersistentObject</span><wbr><span class="parameters">(<a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;file)</span></div>
<div class="block">Simplified constructor configuring for immediate write-back and no persistent file checks.

 <p>
 Equivalent to:
 <blockquote><code>
  PersistentObject(delegate, file, 0L, 0L);
 </code></blockquote></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>delegate</code> - delegate supplying required operations</dd>
<dd><code>file</code> - the file used to persist</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>delegate</code> or <code>file</code> is null</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>PersistentObject</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">PersistentObject</span>()</div>
<div class="block">Default constructor. Caller must still configure the delegate and persistent file prior to start.</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="getDelegate()">
<h3>getDelegate</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;</span>&nbsp;<span class="element-name">getDelegate</span>()</div>
<div class="block">Get the configured <a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a>.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the delegate supplying required operations</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setDelegate(org.dellroad.stuff.pobj.PersistentObjectDelegate)">
<h3>setDelegate</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setDelegate</span><wbr><span class="parameters">(<a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;delegate)</span></div>
<div class="block">Configure the <a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>delegate</code> - delegate supplying required operations</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>delegate</code> is null</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this instance is started</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getFile()">
<h3>getFile</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a></span>&nbsp;<span class="element-name">getFile</span>()</div>
<div class="block">Get the persistent file containing the XML form of the persisted object.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>file used to persist the root object</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setFile(java.io.File)">
<h3>setFile</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setFile</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;file)</span></div>
<div class="block">Set the persistent file containing the XML form of the persisted object.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>file</code> - the file used to persist the root object</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>file</code> is null</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this instance is started</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getWriteDelay()">
<h3>getWriteDelay</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">getWriteDelay</span>()</div>
<div class="block">Get the maximum delay after an update operation before a write-back to the persistent file
 must be initiated.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>write delay in milliseconds, or zero for immediate write-back</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setWriteDelay(long)">
<h3>setWriteDelay</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setWriteDelay</span><wbr><span class="parameters">(long&nbsp;writeDelay)</span></div>
<div class="block">Set the maximum delay after an update operation before a write-back to the persistent file
 must be initiated.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>writeDelay</code> - write delay in milliseconds, or zero for immediate write-back</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>writeDelay</code> is negative</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this instance is started</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getCheckInterval()">
<h3>getCheckInterval</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">getCheckInterval</span>()</div>
<div class="block">Get the delay time between periodic checks for changes in the underlying persistent file.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>check interval in milliseconds, or zero if periodic checks are disabled</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setCheckInterval(long)">
<h3>setCheckInterval</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setCheckInterval</span><wbr><span class="parameters">(long&nbsp;checkInterval)</span></div>
<div class="block">Set the delay time between periodic checks for changes in the underlying persistent file.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>checkInterval</code> - check interval in milliseconds, or zero if periodic checks are disabled</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>writeDelay</code> is negative</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this instance is started</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getVersion()">
<h3>getVersion</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">getVersion</span>()</div>
<div class="block">Get the version of the current root.

 <p>
 This returns a value which increases monotonically with each update.
 The version number is not persisted with the persistent file; each instance of this class keeps
 its own version count. The version is reset to zero when <a href="#stop()"><code>stop()</code></a> is invoked.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the current positive object version, or zero if no value has been loaded yet or this instance is not started</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getNumBackups()">
<h3>getNumBackups</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">getNumBackups</span>()</div>
<div class="block">Get the number of backup copies to preserve.

 <p>
 Backup files have suffixes of the form <code>.1</code>,  <code>.2</code>, etc.,
 in reverse chronological order. Each time a new root object is written, the existing files are rotated.

 <p>
 Back-ups are created via hard links and are only supported on UNIX systems.

 <p>
 The default is zero, which disables backups.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>number of backing file backup copies</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setNumBackups(int)">
<h3>setNumBackups</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setNumBackups</span><wbr><span class="parameters">(int&nbsp;numBackups)</span></div>
<div class="block">Set the number of backup copies to preserve.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>numBackups</code> - number of backing file backup copies</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>numBackups</code> is negative</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if no persistent file has been configured yet</dd>
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="#getNumBackups()"><code>getNumBackups()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isAllowEmptyStart()">
<h3>isAllowEmptyStart</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isAllowEmptyStart</span>()</div>
<div class="block">Determine whether this instance should allow an "empty start".

 <p>
 The default for this property is false.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>if empty starts are allowed</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setAllowEmptyStart(boolean)">
<h3>setAllowEmptyStart</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setAllowEmptyStart</span><wbr><span class="parameters">(boolean&nbsp;allowEmptyStart)</span></div>
<div class="block">Configure whether an "empty start" is allowed.

 <p>
 The default for this property is false.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>allowEmptyStart</code> - true to allow empty starts</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this instance is started</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isAllowEmptyStop()">
<h3>isAllowEmptyStop</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isAllowEmptyStop</span>()</div>
<div class="block">Determine whether this instance should allow an "empty stop".

 <p>
 The default for this property is false.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>true if empty stops are allowed</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setAllowEmptyStop(boolean)">
<h3>setAllowEmptyStop</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setAllowEmptyStop</span><wbr><span class="parameters">(boolean&nbsp;allowEmptyStop)</span></div>
<div class="block">Configure whether an "empty stop" is allowed.

 <p>
 The default for this property is false.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>allowEmptyStop</code> - true to allow empty stops</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this instance is started</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isStarted()">
<h3>isStarted</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isStarted</span>()</div>
<div class="block">Determine whether this instance is started.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>true if this instance currently started</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="start()">
<h3>start</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">start</span>()</div>
<div class="block">Start this instance. Does nothing if already started.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="stop()">
<h3>stop</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">stop</span>()</div>
<div class="block">Stop this instance. Does nothing if already stopped.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if a delayed write back is pending and error occurs while performing the write</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="hasRoot()">
<h3>hasRoot</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">hasRoot</span>()</div>
<div class="block">Determine whether this instance has a non-null root object.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>true if this instance has a non-null root object, false if this instance is not started
  or is in an empty start or empty stop state</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getRoot()">
<h3>getRoot</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="PersistentObject.html" title="type parameter in PersistentObject">T</a></span>&nbsp;<span class="element-name">getRoot</span>()</div>
<div class="block">Atomically read the root object.

 <p>
 In the situation of an empty start or empty stop, this instance is "unconfigured" and null will be returned.
 This can only happen if <a href="#setAllowEmptyStart(boolean)"><code>setAllowEmptyStart(true)</code></a> or <a href="#setAllowEmptyStop(boolean)"><code>setAllowEmptyStop(true)</code></a> has been invoked.

 <p>
 This returns a deep copy of the current root object; any subsequent modifications are not written back.
 Use <a href="#getSharedRoot()"><code>getSharedRoot()</code></a> instead to avoid the cost of the deep copy at the risk of seeing modifications
 caused by other invokers.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the current root instance, or null during an empty start or empty stop</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this instance is not started</dd>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getSharedRoot()">
<h3>getSharedRoot</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="PersistentObject.html" title="type parameter in PersistentObject">T</a></span>&nbsp;<span class="element-name">getSharedRoot</span>()</div>
<div class="block">Get a shared copy of the root object.

 <p>
 This returns a copy of the root object, but it returns the same copy each time until the next change.
 This method is more efficient than <a href="#getRoot()"><code>getRoot()</code></a>, but all callers must agree not to modify the returned object
 or any object in its graph of references.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>shared copy of the root instance, or null during an empty start or empty stop</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this instance is not started</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getRootSnapshot()">
<h3>getRootSnapshot</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="PersistentObject.html" title="class in org.dellroad.stuff.pobj">PersistentObject</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;.<a href="PersistentObject.Snapshot.html" title="class in org.dellroad.stuff.pobj">Snapshot</a></span>&nbsp;<span class="element-name">getRootSnapshot</span>()</div>
<div class="block">Read the root object (as with <a href="#getRoot()"><code>getRoot()</code></a>) and its version (as with <a href="#getVersion()"><code>getVersion()</code></a>) in one atomic operation.
 This avoids the race condition inherent in trying to perform these operations separately.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>snapshot of the current root, or null during an empty start or empty stop</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this instance is not started</dd>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd>
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="#getRoot()"><code>getRoot()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getSharedRootSnapshot()">
<h3>getSharedRootSnapshot</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="PersistentObject.html" title="class in org.dellroad.stuff.pobj">PersistentObject</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;.<a href="PersistentObject.Snapshot.html" title="class in org.dellroad.stuff.pobj">Snapshot</a></span>&nbsp;<span class="element-name">getSharedRootSnapshot</span>()</div>
<div class="block">Read the shared root object (as with <a href="#getSharedRoot()"><code>getSharedRoot()</code></a>) and its version (as with <a href="#getVersion()"><code>getVersion()</code></a>)
 in one atomic operation.
 This avoids the race condition inherent in trying to perform these operations separately.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>snapshot of the current shared root, or null during an empty start or empty stop</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this instance is not started</dd>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd>
<dt>See Also:</dt>
<dd>
<ul class="see-list">
<li><a href="#getSharedRoot()"><code>getSharedRoot()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setRoot(T,long,boolean)">
<h3 id="setRoot(java.lang.Object,long,boolean)">setRoot</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">setRoot</span><wbr><span class="parameters">(<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;newRoot,
 long&nbsp;expectedVersion,
 boolean&nbsp;alreadyValidated)</span></div>
<div class="block">Atomically update the root object.

 <p>
 The given object is deep-copied, the copy replaces the current root, and the new version number is returned.
 If there is no write delay configured, the new version is written to the underlying file immediately and
 a successful return from this method indicates the new root has been persisted. Otherwise, the write will
 occur at a later time in a separate thread.

 <p>
 If <code>expectedVersion</code> is non-zero, then if the current version is not equal to it,
 a <a href="PersistentObjectVersionException.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObjectVersionException</code></a> exception is thrown. This mechanism
 can be used for optimistic locking.

 <p>
 If empty stops are allowed, then <code>newRoot</code> may be null, in which case it replaces the
 current root and subsequent calls to <a href="#getRoot()"><code>getRoot()</code></a> will return null. When a null
 <code>newRoot</code> is set, the persistent file is <b>not</b> modified.

 <p>
 If the given root object is <a href="PersistentObjectDelegate.html#isSameGraph(T,T)">the same as</a> the current
 root object, then no action is taken and the current (unchanged) version number is returned.

 <p>
 After a successful change, any registered <a href="PersistentObjectListener.html" title="interface in org.dellroad.stuff.pobj">listeners</a> are notified in a
 separate thread from the one that invoked this method.

 <p>
 It is possible that this method may succeed, even though writing out the new file fails. In that case,
 <a href="PersistentObjectDelegate.html#handleWritebackException(org.dellroad.stuff.pobj.PersistentObject,java.lang.Throwable)"><code>PersistentObjectDelegate.handleWritebackException()</code></a>
 will be invoked (in a separate thread).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>newRoot</code> - new persistent object</dd>
<dd><code>expectedVersion</code> - expected current version number, or zero to ignore the current version number</dd>
<dd><code>alreadyValidated</code> - true if <code>newRoot</code> has already been validated</dd>
<dt>Returns:</dt>
<dd>the new current version number (unchanged if <code>newRoot</code> is
  <a href="PersistentObjectDelegate.html#isSameGraph(T,T)">the same as</a> the current root)</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>newRoot</code> is null and empty stops are disallowed</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>expectedVersion</code> is negative</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this instance is not started</dd>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd>
<dd><code><a href="PersistentObjectVersionException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectVersionException</a></code> - if <code>expectedVersion</code> is non-zero and not equal to the current version</dd>
<dd><code><a href="PersistentObjectValidationException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectValidationException</a></code> - if the new root has validation errors</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setRoot(T,long)">
<h3 id="setRoot(java.lang.Object,long)">setRoot</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">setRoot</span><wbr><span class="parameters">(<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;newRoot,
 long&nbsp;expectedVersion)</span></div>
<div class="block">Atomically update the root object.

 <p>
 This method is equivalent to:
 <blockquote><code>
  setRoot(newRoot, expectedVersion, false);
 </code></blockquote></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>newRoot</code> - new persistent object</dd>
<dd><code>expectedVersion</code> - expected current version number, or zero to ignore the current version number</dd>
<dt>Returns:</dt>
<dd>the new current version number (unchanged if <code>newRoot</code> is
  <a href="PersistentObjectDelegate.html#isSameGraph(T,T)">the same as</a> the current root)</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setRoot(T)">
<h3 id="setRoot(java.lang.Object)">setRoot</h3>
<div class="member-signature"><span class="modifiers">public final</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">setRoot</span><wbr><span class="parameters">(<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;newRoot)</span></div>
<div class="block">Atomically update the root object.

 <p>
 The is a convenience method, equivalent to:
  <blockquote>
  <code><a href="#setRoot(T,long)"><code>setRoot</code></a>(newRoot, 0)</code>
  </blockquote>

 <p>
 This method cannot throw <a href="PersistentObjectVersionException.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObjectVersionException</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>newRoot</code> - new persistent root object</dd>
<dt>Returns:</dt>
<dd>the new current version number (unchanged if <code>newRoot</code> is
  <a href="PersistentObjectDelegate.html#isSameGraph(T,T)">the same as</a> the current root)</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="checkFile()">
<h3>checkFile</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">checkFile</span>()</div>
<div class="block">Check the persistent file for an "out-of-band" update.

 <p>
 If the persistent file has a newer timestamp than the timestamp of the most recently read
 or written version, then it will be read and applied to this instance.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if this instance is not started</dd>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="addListener(org.dellroad.stuff.pobj.PersistentObjectListener)">
<h3>addListener</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">addListener</span><wbr><span class="parameters">(<a href="PersistentObjectListener.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectListener</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;listener)</span></div>
<div class="block">Add a listener to be notified each time the object graph changes.

 <p>
 Listeners are notified in a separate thread from the one that caused the root object to change.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>listener</code> - listener to add</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>listener</code> is null</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="removeListener(org.dellroad.stuff.pobj.PersistentObjectListener)">
<h3>removeListener</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">removeListener</span><wbr><span class="parameters">(<a href="PersistentObjectListener.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectListener</a>&lt;<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;listener)</span></div>
<div class="block">Remove a listener added via <a href="#addListener(org.dellroad.stuff.pobj.PersistentObjectListener)"><code>addListener()</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>listener</code> - listener to remove</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toString()">
<h3>toString</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">toString</span>()</div>
<div class="block">Get a simple string description of this instance. This description appears in all log messages.</div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a></code>&nbsp;in class&nbsp;<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="read()">
<h3>read</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="PersistentObject.html" title="type parameter in PersistentObject">T</a></span>&nbsp;<span class="element-name">read</span>()</div>
<div class="block">Read the persistent file. Does not validate it.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>root object decoded from backing file</dd>
<dt>Throws:</dt>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if the file does not exist or cannot be read</dd>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="write(T)">
<h3 id="write(java.lang.Object)">write</h3>
<div class="member-signature"><span class="modifiers">protected final</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">write</span><wbr><span class="parameters">(<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;obj)</span></div>
<div class="block">Write the persistent file and rotate any backups.

 <p>
 A temporary file is created in the same directory and then renamed to provide for an atomic update
 (on supporting operating systems).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>obj</code> - root object to write</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>obj</code> is null</dd>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="createResult(java.io.OutputStream,java.io.File)">
<h3>createResult</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/transform/Result.html" title="class or interface in javax.xml.transform" class="external-link">Result</a></span>&nbsp;<span class="element-name">createResult</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link">OutputStream</a>&nbsp;output,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;systemId)</span></div>
<div class="block">Create a <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/transform/Result.html" title="class or interface in javax.xml.transform" class="external-link"><code>Result</code></a> targeting the given <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link"><code>OutputStream</code></a>.

 <p>
 The implementation in <a href="PersistentObject.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObject</code></a> creates and returns a <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/transform/stream/StreamResult.html" title="class or interface in javax.xml.transform.stream" class="external-link"><code>StreamResult</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>output</code> - XML output stream</dd>
<dd><code>systemId</code> - system ID</dd>
<dt>Returns:</dt>
<dd>XML result output</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="notifyListeners(long,T,T)">
<h3 id="notifyListeners(long,java.lang.Object,java.lang.Object)">notifyListeners</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">notifyListeners</span><wbr><span class="parameters">(long&nbsp;newVersion,
 <a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;oldRoot,
 <a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;newRoot)</span></div>
<div class="block">Notify listeners of a change in value.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>newVersion</code> - the version number associated with the new root</dd>
<dd><code>oldRoot</code> - previous root object</dd>
<dd><code>newRoot</code> - new root object</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="read(org.dellroad.stuff.pobj.PersistentObjectDelegate,javax.xml.transform.Source,boolean)">
<h3>read</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type">T</span>&nbsp;<span class="element-name">read</span><wbr><span class="parameters">(<a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/transform/Source.html" title="class or interface in javax.xml.transform" class="external-link">Source</a>&nbsp;source,
 boolean&nbsp;validate)</span></div>
<div class="block">Read in a persistent object using the given delegate.

 <p>
 This is a convenience method that can be used for a one-time deserialization from an XML <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/transform/Source.html" title="class or interface in javax.xml.transform" class="external-link"><code>Source</code></a> without having
 to go through the whole <a href="PersistentObject.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObject</code></a> lifecycle.</div>
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>T</code> - root object type</dd>
<dt>Parameters:</dt>
<dd><code>delegate</code> - delegate supplying required operations</dd>
<dd><code>source</code> - source for serialized root object</dd>
<dd><code>validate</code> - whether to also validate the root object</dd>
<dt>Returns:</dt>
<dd>deserialized root object, never null</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if any parameter is null</dd>
<dd><code><a href="PersistentObjectValidationException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectValidationException</a></code> - if <code>validate</code> is true and the deserialized root has validation errors</dd>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="validate(T)">
<h3 id="validate(java.lang.Object)">validate</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">validate</span><wbr><span class="parameters">(<a href="PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;root)</span></div>
<div class="block">Validate a root object.

 <p>
 Deletgates to <a href="PersistentObjectDelegate.html#validate(T)"><code>PersistentObjectDelegate.validate(T)</code></a> to perform the actual validation.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>root</code> - root object to validate</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>root</code> is null</dd>
<dd><code><a href="PersistentObjectValidationException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectValidationException</a></code> - if the root has validation errors</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="read(org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.File,boolean)">
<h3>read</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type">T</span>&nbsp;<span class="element-name">read</span><wbr><span class="parameters">(<a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;file,
 boolean&nbsp;validate)</span></div>
<div class="block">Read in a persistent object from the given <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link"><code>File</code></a> using the given delegate.

 <p>
 This is a wrapper around <a href="#read(org.dellroad.stuff.pobj.PersistentObjectDelegate,javax.xml.transform.Source,boolean)"><code>read(PersistentObjectDelegate, Source, boolean)</code></a> that handles
 opening and closing the given <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link"><code>File</code></a>.</div>
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>T</code> - root object type</dd>
<dt>Parameters:</dt>
<dd><code>delegate</code> - delegate supplying required operations</dd>
<dd><code>file</code> - file to read from</dd>
<dd><code>validate</code> - whether to also validate the root object</dd>
<dt>Returns:</dt>
<dd>deserialized root object, never null</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if any parameter is null</dd>
<dd><code><a href="PersistentObjectValidationException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectValidationException</a></code> - if <code>validate</code> is true and the deserialized root has validation errors</dd>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if <code>file</code> cannot be read</dd>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="read(org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.InputStream,boolean)">
<h3>read</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type">T</span>&nbsp;<span class="element-name">read</span><wbr><span class="parameters">(<a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/InputStream.html" title="class or interface in java.io" class="external-link">InputStream</a>&nbsp;input,
 boolean&nbsp;validate)</span></div>
<div class="block">Read in a persistent object from the given <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/InputStream.html" title="class or interface in java.io" class="external-link"><code>InputStream</code></a> using the given delegate.

 <p>
 This is a wrapper around <a href="#read(org.dellroad.stuff.pobj.PersistentObjectDelegate,javax.xml.transform.Source,boolean)"><code>read(PersistentObjectDelegate, Source, boolean)</code></a>.</div>
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>T</code> - root object type</dd>
<dt>Parameters:</dt>
<dd><code>delegate</code> - delegate supplying required operations</dd>
<dd><code>input</code> - input to read from</dd>
<dd><code>validate</code> - whether to also validate the root object</dd>
<dt>Returns:</dt>
<dd>deserialized root object, never null</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if any parameter is null</dd>
<dd><code><a href="PersistentObjectValidationException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectValidationException</a></code> - if <code>validate</code> is true and the deserialized root has validation errors</dd>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an I/O error occurs</dd>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="write(T,org.dellroad.stuff.pobj.PersistentObjectDelegate,javax.xml.transform.Result)">
<h3 id="write(java.lang.Object,org.dellroad.stuff.pobj.PersistentObjectDelegate,javax.xml.transform.Result)">write</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">write</span><wbr><span class="parameters">(T&nbsp;root,
 <a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/transform/Result.html" title="class or interface in javax.xml.transform" class="external-link">Result</a>&nbsp;result)</span></div>
<div class="block">Write a persistent object using the given delegate.

 <p>
 This is a convenience method that can be used for one-time serialization to an XML <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/transform/Result.html" title="class or interface in javax.xml.transform" class="external-link"><code>Result</code></a> without having
 to go through the whole <a href="PersistentObject.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObject</code></a> lifecycle.</div>
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>T</code> - root object type</dd>
<dt>Parameters:</dt>
<dd><code>root</code> - root object to serialize</dd>
<dd><code>delegate</code> - delegate supplying required operations</dd>
<dd><code>result</code> - destination</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if any parameter is null</dd>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="write(T,org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.File)">
<h3 id="write(java.lang.Object,org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.File)">write</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">write</span><wbr><span class="parameters">(T&nbsp;root,
 <a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link">File</a>&nbsp;file)</span></div>
<div class="block">Write a persistent object using the given delegate.

 <p>
 This is a wrapper around <a href="#write(T,org.dellroad.stuff.pobj.PersistentObjectDelegate,javax.xml.transform.Result)"><code>write(Object, PersistentObjectDelegate, Result)</code></a> that handles
 opening and closing the given <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/File.html" title="class or interface in java.io" class="external-link"><code>File</code></a>.</div>
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>T</code> - root object type</dd>
<dt>Parameters:</dt>
<dd><code>root</code> - root object to serialize</dd>
<dd><code>delegate</code> - delegate supplying required operations</dd>
<dd><code>file</code> - destination file</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if any parameter is null</dd>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="write(T,org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.OutputStream)">
<h3 id="write(java.lang.Object,org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.OutputStream)">write</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">write</span><wbr><span class="parameters">(T&nbsp;root,
 <a href="PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/OutputStream.html" title="class or interface in java.io" class="external-link">OutputStream</a>&nbsp;output)</span></div>
<div class="block">Write a persistent object using the given delegate.

 <p>
 This is a wrapper around <a href="#write(T,org.dellroad.stuff.pobj.PersistentObjectDelegate,javax.xml.transform.Result)"><code>write(Object, PersistentObjectDelegate, Result)</code></a>.</div>
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><code>T</code> - root object type</dd>
<dt>Parameters:</dt>
<dd><code>root</code> - root object to serialize</dd>
<dd><code>delegate</code> - delegate supplying required operations</dd>
<dd><code>output</code> - XML destination</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if any parameter is null</dd>
<dd><code><a href="PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2024. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
